<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE ModelUnit PUBLIC " "
        "https://raw.githubusercontent.com/AgriculturalModelExchangeInitiative/crop2ml/master/ModelUnit.dtd">
<ModelUnit modelid="Monica_Evapotranspiration.Evapotranspiration"
           name="Evapotranspiration"
           timestep="1" version="1">
    <Description>
        <Title>MONICA evapotranspiration model</Title>
        <Authors>Claas Nendel (transcription into Crop2ML by Michael Berg-Mohnicke)</Authors>
        <Institution>ZALF e.V.</Institution>
        <URI></URI>
        <Reference></Reference>
        <ExtendedDescription></ExtendedDescription>
        <ShortDescription>Calculates the MONICA evapotranspiration</ShortDescription>
    </Description>
    <Inputs>
        <!-- parameters -->
        <Input name="evaporation_zeta" description="shape factor"
               inputtype="parameter" parametercategory="constant"
               datatype="DOUBLE" max="40" min="0" default="40" unit="dimensionless"/>
        <Input name="maximum_evaporation_impact_depth" description="maximumEvaporationImpactDepth"
               inputtype="parameter" parametercategory="constant"
               datatype="DOUBLE" max="" min="0" default="5" unit="dm"/>
        <Input name="evaporation_reduction_method" description="THESEUS (0) or HERMES (1) evaporation reduction method"
               inputtype="parameter" parametercategory="constant"
               datatype="INT" max="1" min="0" default="1" unit="dimensionless"/>
        <Input name="xsa_critical_soil_moisture" description="XSACriticalSoilMoisture"
               inputtype="parameter" parametercategory="constant"
               datatype="DOUBLE" max="1.5" min="0" default="0.1" unit="m3/m3"/>
        <Input name="no_of_soil_layers" description="number of soil layers"
               inputtype="parameter" parametercategory="constant"
               datatype="INT" max="" min="0" default="20" unit="dimensionless"/>
        <Input name="no_of_soil_moisture_layers" description="number of soil layers + 1"
               inputtype="parameter" parametercategory="constant"
               datatype="INT" max="" min="0" default="21" unit="dimensionless"/>
        <Input name="layer_thickness" description="layer thickness array"
               inputtype="parameter" parametercategory="constant"
               datatype="DOUBLEARRAY" len="no_of_soil_moisture_layers" max="" min="" default="" unit="m"/>
        <Input name="permanent_wilting_point" description="permanent wilting point array"
               inputtype="parameter" parametercategory="constant"
               datatype="DOUBLEARRAY" len="no_of_soil_moisture_layers" max="" min="" default="" unit="m3/m3"/>
        <Input name="field_capacity" description="field capacity array"
               inputtype="parameter" parametercategory="constant"
               datatype="DOUBLEARRAY" len="no_of_soil_moisture_layers" max="" min="" default="" unit="m3/m3"/>

        <!-- exogenous -->
        <Input name="kc_factor" description="crop coefficient ETc/ET0"
               inputtype="variable" variablecategory="exogenous"
               datatype="DOUBLE" max="" min="0" default="0.75" unit="dimensionless"/>
        <Input name="has_snow_cover" description="is the soil covered by snow"
               inputtype="variable" variablecategory="exogenous"
               datatype="BOOLEAN" default="false" unit="dimensionless"/>
        <Input name="developmental_stage" description="MONICA crop developmental stage"
               inputtype="variable" variablecategory="exogenous"
               datatype="INT" max="6" min="0" default="0" unit="dimensionless"/>
        <Input name="crop_transpiration" description="crop transpiration array"
               inputtype="variable" variablecategory="exogenous"
               datatype="DOUBLEARRAY" len="no_of_soil_moisture_layers" max="" min="" default="" unit="mm"/>
        <Input name="crop_evaporated_from_intercepted" description="crop evaporated water from intercepted water"
               inputtype="variable" variablecategory="exogenous"
               datatype="DOUBLE" max="" min="" default="" unit="mm"/>
        <Input name="percentage_soil_coverage" description="fraction of soil covered by crop"
               inputtype="variable" variablecategory="exogenous"
               datatype="DOUBLE" max="1" min="0" default="0" unit="m2/m2"/>

        <!-- auxiliary -->
         <Input name="potential_evapotranspiration"
               description="the potential evapotranspiration"
               inputtype="variable" variablecategory="auxiliary"
               datatype="DOUBLE" max="" min="0" default="0" unit="mm"/>

        <!-- states -->
        <Input name="surface_water_storage" description="Simulates a virtual layer that contains the surface water"
               inputtype="variable" variablecategory="state"
               datatype="DOUBLE" max="" min="0" default="0" unit="mm"/>
        <Input name="evaporated_from_surface" description="evaporated_from_surface"
               inputtype="variable" variablecategory="state"
               datatype="DOUBLE" max="" min="0" default="0" unit="mm"/>
        <Input name="actual_evaporation" description="actual evaporation"
               inputtype="variable" variablecategory="state"
               datatype="DOUBLE" max="" min="0" default="0" unit="mm"/>
        <Input name="actual_transpiration" description="actual transpiration"
               inputtype="variable" variablecategory="state"
               datatype="DOUBLE" max="" min="0" default="0" unit="mm"/>
        <Input name="soil_moisture" description="soil moisture array"
               inputtype="variable" variablecategory="state"
               datatype="DOUBLEARRAY" len="no_of_soil_moisture_layers" max="" min="" default="" unit="m3/m3"/>
        <Input name="evaporation" description="evaporation array"
               inputtype="variable" variablecategory="state"
               datatype="DOUBLEARRAY" len="no_of_soil_moisture_layers" max="" min="" default="" unit="mm"/>
        <Input name="transpiration" description="transpiration array"
               inputtype="variable" variablecategory="state"
               datatype="DOUBLEARRAY" len="no_of_soil_moisture_layers" max="" min="" default="" unit="mm"/>
        <Input name="evapotranspiration" description="evapotranspiration array"
               inputtype="variable" variablecategory="state"
               datatype="DOUBLEARRAY" len="no_of_soil_moisture_layers" max="" min="" default="" unit="mm"/>
        <Input name="actual_evapotranspiration" description="actual evapotranspiration"
               inputtype="variable" variablecategory="state"
               datatype="DOUBLE" max="" min="0" default="0" unit="mm"/>
    </Inputs>
    <Outputs>
        <Output name="evaporated_from_surface" description=""
                variablecategory="state"
                datatype="DOUBLE" max="" min="0" unit="mm"/>
        <Output name="actual_evapotranspiration" description="actual evapotranspiration"
                variablecategory="state"
                datatype="DOUBLE" max="200" min="0" unit="mm"/>
        <Output name="actual_evaporation" description="actual evaporation"
                variablecategory="state"
               datatype="DOUBLE" max="" min="0" unit="mm"/>
        <Output name="actual_transpiration" description="actual transpiration"
                variablecategory="state"
               datatype="DOUBLE" max="" min="0" unit="mm"/>
        <Output name="surface_water_storage" description="Simulates a virtual layer that contains the surface water"
               variablecategory="state"
                datatype="DOUBLE" max="" min="0" unit="mm"/>
        <Output name="soil_moisture" description="soil moisture array"
                variablecategory="state"
                datatype="DOUBLEARRAY" len="no_of_soil_moisture_layers" max="" min="" unit="m3/m3"/>
    </Outputs>
    <Initialization name="init_evapotranspiration" language="cyml"
                    filename="algo/pyx/init_evapotranspiration.pyx"/>
    <Function name="bound" description="helper functions for evapotranspiration code"
              language="cyml" type="external"
              filename="algo/pyx/helpers/bound.pyx"/>
    <Function name="ET_functions" description="helper functions for evapotranspiration code"
              language="cyml" type="external"
              filename="algo/pyx/helpers/ET_functions.pyx"/>
    <Algorithm language="cyml" platform=""
               filename="algo/pyx/evapotranspiration.pyx"/>
    <Parametersets/>
    <Testsets/>
</ModelUnit>